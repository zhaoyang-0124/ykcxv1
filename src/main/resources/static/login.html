<!doctype html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>SPIC 在线答题登录</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        :root { --primary:#0b5fff; --bg:#f5f7fb; --card:#fff; --text:#1f2d3d; --muted:#6b778c; }
        * { box-sizing:border-box; }
        body {
            margin:0; min-height:100vh; background:linear-gradient(135deg, #eef3ff 0%, #f7f9ff 100%);
            font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial;
            display:flex; align-items:center; justify-content:center; padding:20px;
        }
        .card {
            width:100%; max-width:960px; background:var(--card); border-radius:16px;
            box-shadow:0 10px 30px rgba(11,95,255,.12); display:grid; grid-template-columns: 1.1fr 1fr;
            overflow:hidden;
        }
        .hero {
            position:relative; background:radial-gradient(1200px 600px at 20% -10%, #e6efff, transparent),
        radial-gradient(800px 400px at 120% 110%, #e6f7ff, transparent);
            display:flex; align-items:center; justify-content:center; padding:24px;
        }
        .hero img { max-width:88%; height:auto; filter: drop-shadow(0 12px 24px rgba(11,95,255,.25)); }
        .form {
            padding:40px 36px;
            display:flex; flex-direction:column; justify-content:center;
        }
        h1 { margin:0 0 8px; font-size:24px; color:var(--text); }
        p.subtitle { margin:0 0 28px; color:var(--muted); }
        label { display:block; font-size:13px; color:#42526e; margin:14px 0 6px; }
        input {
            width:100%; padding:12px 14px; border:1px solid #dde3ee; border-radius:10px; outline:none;
            transition:.15s border,.15s box-shadow; background:#fafbff;
        }
        input:focus { border-color:var(--primary); box-shadow:0 0 0 3px rgba(11,95,255,.15); background:#fff; }
        .row { display:flex; align-items:center; justify-content:space-between; margin:12px 0 4px; }
        .error { color:#d14343; font-size:13px; height:18px; margin:6px 0 0; }
        button {
            width:100%; margin-top:18px; padding:12px 16px; border:none; border-radius:10px; color:#fff;
            background:linear-gradient(135deg, #0b5fff 0%, #3a7bff 100%); font-weight:600; cursor:pointer;
            box-shadow:0 8px 20px rgba(11,95,255,.25); transition:transform .06s ease, box-shadow .2s ease;
        }
        button:hover { box-shadow:0 10px 24px rgba(11,95,255,.32); }
        button:active { transform: translateY(1px); }
        .hint { color:#7a869a; font-size:12px; text-align:center; margin-top:12px; }
        @media (max-width: 860px) {
            .card { grid-template-columns: 1fr; }
            .hero { display:none; }
        }
    </style>
</head>
<body>
<div class="card">
    <div class="hero">
        <!-- 替换为你的 SPIC 图片路径 -->
        <img src="SPIC.png" alt="SPIC">
    </div>
    <div class="form">
        <h1>锦州港口公司欢迎你！</h1>
        <p class="subtitle">请输入账号与密码进入锦州港口公司一体化页面</p>

        <form id="loginForm">
            <div class="form-group">
                <label for="username">用户名:</label>
                <input type="text" id="username" name="username" required>
            </div>
            <div class="form-group">
                <label for="password">密码:</label>
                <input type="password" id="password" name="password" required>
            </div>
            <button type="submit">登录</button>
        </form>
        <div id="message" class="error-message"></div>
    </div>
</div>

<script>
    const $ = (id) => document.getElementById(id);
    const userKey = 'spic_login_user';

    // 读取记住的账号
    const saved = localStorage.getItem(userKey);
    if (saved) {
        try {
            const obj = JSON.parse(saved);
            if (obj.username) $('username').value = obj.username;
            if (obj.remember) $('remember').checked = true;
        } catch {}
    }

    document.getElementById('loginForm').addEventListener('submit', async function(e) {
        e.preventDefault();

        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;
        const messageDiv = document.getElementById('message');
        // 清空之前的消息
        messageDiv.textContent = '';
        messageDiv.className = 'error-message';
        try {
            const response = await fetch('http://127.0.0.1:8989/jinzhouport/client/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    username: username,
                    password: password
                })
            });
            const result = await response.json();
            if (result.success) {
                messageDiv.textContent = result.message;
                messageDiv.className = 'success-message';

                // 登录成功后可以跳转到其他页面或存储token
                if (result.token) {
                    localStorage.setItem('authToken', result.token);
                    localStorage.setItem('userInfo', JSON.stringify(result.userInfo));
                    // 模拟跳转到主页
                    setTimeout(() => {
                        window.location.href = 'mainbody.html';
                    }, 1500);
                }
            } else {
                messageDiv.textContent = result.message;
                messageDiv.className = 'error-message';
            }
        } catch (error) {
            messageDiv.textContent = '登录请求失败: ' + error.message;
            messageDiv.className = 'error-message';
        }
    });
</script>
</body>
</html>